library(rehh)

#Loading PopGenome package
library(PopGenome)

#Reading the genome data
hh <- data2haplohh(hap_file = "/Users/samanthacardenas/Downloads/Genome Data/Genomes/ABCC3.HC3202_chr17.49634881-51692253.vcf.gz", polarize_vcf = FALSE, vcf_reader = "data.table")

#Using the scan_hh function to find the EHH values of the first 100 markers in the sample data
scan <- scan_hh(hh)
scan
CHR POSITION    FREQ_A       FREQ_D NHAPLO_A NHAPLO_D IHH_A      IHH_D IES INES
1   chr17 49634949 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
2   chr17 49634976 0.2726421 0.7273579013     1746     4658    NA         NA  NA   NA
3   chr17 49634977 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
4   chr17 49634989 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
5   chr17 49635043 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
6   chr17 49635065 0.9996877 0.0003123048     6402        2    NA   592.2775  NA   NA
7   chr17 49635079 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
8   chr17 49635103 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
9   chr17 49635155 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
10  chr17 49635222 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
11  chr17 49635250 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
12  chr17 49635273 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
13  chr17 49635284 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
14  chr17 49635383 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
15  chr17 49635392 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
16  chr17 49635416 0.9995315 0.0003123048     6401        2    NA         NA  NA   NA
17  chr17 49635417 0.9993754 0.0003123048     6400        2    NA         NA  NA   NA
18  chr17 49635422 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
19  chr17 49635433 0.9985946 0.0014053716     6395        9    NA         NA  NA   NA
20  chr17 49635500 0.9979700 0.0012492192     6391        8    NA         NA  NA   NA
21  chr17 49635505 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
22  chr17 49635507 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
23  chr17 49635514 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
24  chr17 49635571 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
25  chr17 49635632 0.7126796 0.2743597751     4564     1757    NA         NA  NA   NA
26  chr17 49635653 0.9817302 0.0182698314     6287      117    NA         NA  NA   NA
27  chr17 49635655 0.9985946 0.0014053716     6395        9    NA         NA  NA   NA
28  chr17 49635658 0.9886009 0.0101499063     6331       65    NA         NA  NA   NA
29  chr17 49635698 0.9865709 0.0134291068     6318       86    NA         NA  NA   NA
30  chr17 49635751 0.9861024 0.0138975640     6315       89    NA         NA  NA   NA
31  chr17 49635780 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
32  chr17 49635794 0.9975016 0.0024984385     6388       16    NA         NA  NA   NA
33  chr17 49635811 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
34  chr17 49635815 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
35  chr17 49635897 0.8616490 0.1383510306     5518      886    NA         NA  NA   NA
36  chr17 49635903 0.9995315 0.0004684572     6401        3    NA  1936.5242  NA   NA
37  chr17 49635923 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
38  chr17 49635924 0.9987508 0.0012492192     6396        8    NA         NA  NA   NA
39  chr17 49635925 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
40  chr17 49635927 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
41  chr17 49635997 0.9995315 0.0004684572     6401        3    NA  2798.4075  NA   NA
42  chr17 49636065 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
43  chr17 49636074 0.9995315 0.0004684572     6401        3    NA         NA  NA   NA
44  chr17 49636081 0.9990631 0.0009369144     6398        6    NA         NA  NA   NA
45  chr17 49636102 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
46  chr17 49636104 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
47  chr17 49636106 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
48  chr17 49636116 0.9996877 0.0003123048     6402        2    NA 13507.8363  NA   NA
49  chr17 49636143 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
50  chr17 49636163 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
51  chr17 49636182 0.9987508 0.0012492192     6396        8    NA         NA  NA   NA
52  chr17 49636207 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
53  chr17 49636231 0.9995315 0.0004684572     6401        3    NA         NA  NA   NA
54  chr17 49636245 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
55  chr17 49636256 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
56  chr17 49636266 0.9989069 0.0010930668     6397        7    NA         NA  NA   NA
57  chr17 49636290 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
58  chr17 49636300 0.9996877 0.0003123048     6402        2    NA  5162.7988  NA   NA
59  chr17 49636324 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
60  chr17 49636347 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
61  chr17 49636362 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
62  chr17 49636373 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
63  chr17 49636452 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
64  chr17 49636472 0.9996877 0.0003123048     6402        2    NA  2539.9675  NA   NA
65  chr17 49636550 0.9962523 0.0037476577     6380       24    NA         NA  NA   NA
66  chr17 49636615 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
67  chr17 49636640 0.9990631 0.0009369144     6398        6    NA         NA  NA   NA
68  chr17 49636644 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
69  chr17 49636787 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
70  chr17 49636811 0.9970331 0.0029668957     6385       19    NA         NA  NA   NA
71  chr17 49636820 0.9992192 0.0007807620     6399        5    NA         NA  NA   NA
72  chr17 49636920 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
73  chr17 49636960 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
74  chr17 49636983 0.9995315 0.0004684572     6401        3    NA         NA  NA   NA
75  chr17 49637004 0.9995315 0.0004684572     6401        3    NA  4682.7508  NA   NA
76  chr17 49637011 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
77  chr17 49637013 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
78  chr17 49637137 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
79  chr17 49637172 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
80  chr17 49637175 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
81  chr17 49637176 0.9996877 0.0003123048     6402        2    NA  4485.6862  NA   NA
82  chr17 49637197 0.9996877 0.0003123048     6402        2    NA         NA  NA   NA
83  chr17 49637216 0.9937539 0.0062460962     6364       40    NA         NA  NA   NA
84  chr17 49637232 0.9943785 0.0056214866     6368       36    NA         NA  NA   NA
85  chr17 49637362 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
86  chr17 49637414 0.9993754 0.0006246096     6400        4    NA         NA  NA   NA
87  chr17 49637446 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
88  chr17 49637458 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
89  chr17 49637501 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
90  chr17 49637508 0.9926608 0.0073391630     6357       47    NA         NA  NA   NA
91  chr17 49637516 0.9996877 0.0003123048     6402        2    NA 10651.6138  NA   NA
92  chr17 49637540 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
93  chr17 49637588 0.9984385 0.0015615240     6394       10    NA         NA  NA   NA
94  chr17 49637602 0.9975016 0.0024984385     6388       16    NA         NA  NA   NA
95  chr17 49637630 0.9921924 0.0078076202     6354       50    NA         NA  NA   NA
96  chr17 49637650 0.9989069 0.0010930668     6397        7    NA         NA  NA   NA
97  chr17 49637656 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
98  chr17 49637680 0.9989069 0.0010930668     6397        7    NA         NA  NA   NA
99  chr17 49637724 0.9962523 0.0037476577     6380       24    NA         NA  NA   NA
100 chr17 49637733 0.9998438 0.0001561524     6403        1    NA     0.0000  NA   NA
[ reached 'max' / getOption("max.print") -- omitted 1235 rows ]

#Adding IHS values to scan and ihs get the maximum IHH and IHS
scan <- scan_hh(hh, polarized=FALSE)
scan
CHR POSITION  FREQ_MAJ     FREQ_MIN NHAPLO_MAJ NHAPLO_MIN IHH_MAJ    IHH_MIN IES INES
1   chr17 49634949 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
2   chr17 49634976 0.7273579 0.2726420987       4658       1746      NA         NA  NA   NA
3   chr17 49634977 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
4   chr17 49634989 0.9993754 0.0006246096       6400          4      NA         NA  NA   NA
5   chr17 49635043 0.9996877 0.0003123048       6402          2      NA         NA  NA   NA
6   chr17 49635065 0.9996877 0.0003123048       6402          2      NA   592.2775  NA   NA
7   chr17 49635079 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
8   chr17 49635103 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
9   chr17 49635155 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
10  chr17 49635222 0.9993754 0.0006246096       6400          4      NA         NA  NA   NA
11  chr17 49635250 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
12  chr17 49635273 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
13  chr17 49635284 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
14  chr17 49635383 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
15  chr17 49635392 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
16  chr17 49635416 0.9995315 0.0003123048       6401          2      NA         NA  NA   NA
17  chr17 49635417 0.9993754 0.0003123048       6400          2      NA         NA  NA   NA
18  chr17 49635422 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
19  chr17 49635433 0.9985946 0.0014053716       6395          9      NA         NA  NA   NA
20  chr17 49635500 0.9979700 0.0012492192       6391          8      NA         NA  NA   NA
21  chr17 49635505 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
22  chr17 49635507 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
23  chr17 49635514 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
24  chr17 49635571 0.9996877 0.0003123048       6402          2      NA         NA  NA   NA
25  chr17 49635632 0.7126796 0.2743597751       4564       1757      NA         NA  NA   NA
26  chr17 49635653 0.9817302 0.0182698314       6287        117      NA         NA  NA   NA
27  chr17 49635655 0.9985946 0.0014053716       6395          9      NA         NA  NA   NA
28  chr17 49635658 0.9886009 0.0101499063       6331         65      NA         NA  NA   NA
29  chr17 49635698 0.9865709 0.0134291068       6318         86      NA         NA  NA   NA
30  chr17 49635751 0.9861024 0.0138975640       6315         89      NA         NA  NA   NA
31  chr17 49635780 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
32  chr17 49635794 0.9975016 0.0024984385       6388         16      NA         NA  NA   NA
33  chr17 49635811 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
34  chr17 49635815 0.9992192 0.0007807620       6399          5      NA         NA  NA   NA
35  chr17 49635897 0.8616490 0.1383510306       5518        886      NA         NA  NA   NA
36  chr17 49635903 0.9995315 0.0004684572       6401          3      NA  1936.5242  NA   NA
37  chr17 49635923 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
38  chr17 49635924 0.9987508 0.0012492192       6396          8      NA         NA  NA   NA
39  chr17 49635925 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
40  chr17 49635927 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
41  chr17 49635997 0.9995315 0.0004684572       6401          3      NA  2798.4075  NA   NA
42  chr17 49636065 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
43  chr17 49636074 0.9995315 0.0004684572       6401          3      NA         NA  NA   NA
44  chr17 49636081 0.9990631 0.0009369144       6398          6      NA         NA  NA   NA
45  chr17 49636102 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
46  chr17 49636104 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
47  chr17 49636106 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
48  chr17 49636116 0.9996877 0.0003123048       6402          2      NA 13507.8363  NA   NA
49  chr17 49636143 0.9992192 0.0007807620       6399          5      NA         NA  NA   NA
50  chr17 49636163 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
51  chr17 49636182 0.9987508 0.0012492192       6396          8      NA         NA  NA   NA
52  chr17 49636207 0.9993754 0.0006246096       6400          4      NA         NA  NA   NA
53  chr17 49636231 0.9995315 0.0004684572       6401          3      NA         NA  NA   NA
54  chr17 49636245 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
55  chr17 49636256 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
56  chr17 49636266 0.9989069 0.0010930668       6397          7      NA         NA  NA   NA
57  chr17 49636290 0.9992192 0.0007807620       6399          5      NA         NA  NA   NA
58  chr17 49636300 0.9996877 0.0003123048       6402          2      NA  5162.7988  NA   NA
59  chr17 49636324 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
60  chr17 49636347 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
61  chr17 49636362 0.9996877 0.0003123048       6402          2      NA         NA  NA   NA
62  chr17 49636373 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
63  chr17 49636452 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
64  chr17 49636472 0.9996877 0.0003123048       6402          2      NA  2539.9675  NA   NA
65  chr17 49636550 0.9962523 0.0037476577       6380         24      NA         NA  NA   NA
66  chr17 49636615 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
67  chr17 49636640 0.9990631 0.0009369144       6398          6      NA         NA  NA   NA
68  chr17 49636644 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
69  chr17 49636787 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
70  chr17 49636811 0.9970331 0.0029668957       6385         19      NA         NA  NA   NA
71  chr17 49636820 0.9992192 0.0007807620       6399          5      NA         NA  NA   NA
72  chr17 49636920 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
73  chr17 49636960 0.9996877 0.0003123048       6402          2      NA         NA  NA   NA
74  chr17 49636983 0.9995315 0.0004684572       6401          3      NA         NA  NA   NA
75  chr17 49637004 0.9995315 0.0004684572       6401          3      NA  4682.7508  NA   NA
76  chr17 49637011 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
77  chr17 49637013 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
78  chr17 49637137 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
79  chr17 49637172 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
80  chr17 49637175 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
81  chr17 49637176 0.9996877 0.0003123048       6402          2      NA  4485.6862  NA   NA
82  chr17 49637197 0.9996877 0.0003123048       6402          2      NA         NA  NA   NA
83  chr17 49637216 0.9937539 0.0062460962       6364         40      NA         NA  NA   NA
84  chr17 49637232 0.9943785 0.0056214866       6368         36      NA         NA  NA   NA
85  chr17 49637362 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
86  chr17 49637414 0.9993754 0.0006246096       6400          4      NA         NA  NA   NA
87  chr17 49637446 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
88  chr17 49637458 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
89  chr17 49637501 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
90  chr17 49637508 0.9926608 0.0073391630       6357         47      NA         NA  NA   NA
91  chr17 49637516 0.9996877 0.0003123048       6402          2      NA 10651.6138  NA   NA
92  chr17 49637540 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
93  chr17 49637588 0.9984385 0.0015615240       6394         10      NA         NA  NA   NA
94  chr17 49637602 0.9975016 0.0024984385       6388         16      NA         NA  NA   NA
95  chr17 49637630 0.9921924 0.0078076202       6354         50      NA         NA  NA   NA
96  chr17 49637650 0.9989069 0.0010930668       6397          7      NA         NA  NA   NA
97  chr17 49637656 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
98  chr17 49637680 0.9989069 0.0010930668       6397          7      NA         NA  NA   NA
99  chr17 49637724 0.9962523 0.0037476577       6380         24      NA         NA  NA   NA
100 chr17 49637733 0.9998438 0.0001561524       6403          1      NA     0.0000  NA   NA
[ reached 'max' / getOption("max.print") -- omitted 1235 rows ]
ihs <- ihh2ihs(scan, freqbin=1)
ihs
CHR POSITION        IHS  LOGPVALUE
2    chr17 49634976         NA         NA
25   chr17 49635632         NA         NA
35   chr17 49635897         NA         NA
103  chr17 49637910         NA         NA
124  chr17 49638578         NA         NA
125  chr17 49638583         NA         NA
142  chr17 49638948         NA         NA
181  chr17 49640369         NA         NA
193  chr17 49640826         NA         NA
198  chr17 49641108         NA         NA
277  chr17 49642736         NA         NA
312  chr17 49643653         NA         NA
322  chr17 49643932         NA         NA
385  chr17 49645867         NA         NA
420  chr17 49646850         NA         NA
434  chr17 49647115         NA         NA
452  chr17 49647347  1.7567452 1.10258603
471  chr17 49647819         NA         NA
546  chr17 49650110  0.5022210 0.21076341
568  chr17 49650737         NA         NA
574  chr17 49651197         NA         NA
576  chr17 49651241         NA         NA
616  chr17 49652644         NA         NA
738  chr17 49656031 -0.1366615 0.04997691
791  chr17 49657696         NA         NA
891  chr17 49660367         NA         NA
908  chr17 49660740         NA         NA
921  chr17 49661184 -1.3328872 0.73857338
933  chr17 49661680 -0.9522665 0.46729425
948  chr17 49662013  0.8378680 0.39566070
955  chr17 49662162         NA         NA
1041 chr17 49664915 -0.4593618 0.18978469
1050 chr17 49665136         NA         NA
1055 chr17 49665277 -0.2156572 0.08131191
1069 chr17 49665479         NA         NA
1075 chr17 49665653         NA         NA
1076 chr17 49665659         NA         NA
1080 chr17 49665699         NA         NA
1102 chr17 49666458         NA         NA
1150 chr17 49667178         NA         NA
1161 chr17 49667293         NA         NA
1194 chr17 49667931         NA         NA
1224 chr17 49668775         NA         NA
1248 chr17 49669075         NA         NA
1260 chr17 49669429         NA         NA
1273 chr17 49669763         NA         NA
1277 chr17 49669922         NA         NA
1284 chr17 49670286         NA         NA

$frequency.class
N_MRK MEAN_UNIHS  SD_UNIHS    LOWER_QT  UPPER_QT
[0.05,0.95)    48  0.2691873 0.2868006 -0.09398207 0.7269043
#Maximum value for IHS is 1.7567452 based on the data frame displaying IHS. The $frequency.class represents other relevant statistics regarding IHS values
