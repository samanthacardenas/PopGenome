#Loading rehh package
library(rehh)

#Installing and loading PopGenome package
install.packages("PopGenome")
library(PopGenome)

#Installing and loading the vcfR file to read the vcf file 
install.packages("vcfR")
library(vcfR)

#Reading the genome data
hh <- data2haplohh(hap_file = "/Users/samanthacardenas/Downloads/Genome Data/Genomes/FADS1-3.HC3202_chr11.60799627-62891545.vcf.gz", polarize_vcf = FALSE, vcf_reader = "data.table")

#Using the scan_hh function to find the EHH values of the first 100 markers in the sample data
scan <- scan_hh(hh)
scan
#CHR POSITION     FREQ_A       FREQ_D NHAPLO_A NHAPLO_D IHH_A     IHH_D IES INES
#1   chr11 60799641 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#2   chr11 60799676 0.99937539 0.0006246096     6400        4    NA        NA  NA   NA
#3   chr11 60799694 0.99921924 0.0007807620     6399        5    NA        NA  NA   NA
#4   chr11 60799757 0.46392879 0.5360712055     2971     3433    NA        NA  NA   NA
#5   chr11 60799770 0.99297314 0.0070268582     6359       45    NA        NA  NA   NA
#6   chr11 60799781 0.99937539 0.0006246096     6400        4    NA        NA  NA   NA
#7   chr11 60799799 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#8   chr11 60799802 0.02373517 0.9762648345      152     6252    NA        NA  NA   NA
#9   chr11 60799812 0.99937539 0.0006246096     6400        4    NA        NA  NA   NA
#10  chr11 60799854 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#11  chr11 60799855 0.99937539 0.0004684572     6400        3    NA        NA  NA   NA
#12  chr11 60799862 0.99937539 0.0006246096     6400        4    NA        NA  NA   NA
#13  chr11 60799876 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#14  chr11 60799885 0.99297314 0.0070268582     6359       45    NA        NA  NA   NA
#15  chr11 60799895 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#16  chr11 60799942 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#17  chr11 60799977 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#18  chr11 60799984 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#19  chr11 60799989 0.99921924 0.0007807620     6399        5    NA        NA  NA   NA
#20  chr11 60800013 0.99250468 0.0074953154     6356       48    NA        NA  NA   NA
#21  chr11 60800018 0.99594004 0.0040599625     6378       26    NA        NA  NA   NA
#22  chr11 60800052 0.49953154 0.5004684572     3199     3205    NA        NA  NA   NA
#23  chr11 60800061 0.46392879 0.5360712055     2971     3433    NA        NA  NA   NA
#24  chr11 60800116 0.46408495 0.5359150531     2972     3432    NA        NA  NA   NA
#25  chr11 60800129 0.99968770 0.0003123048     6402        2    NA  112.5275  NA   NA
#26  chr11 60800151 0.99953154 0.0004684572     6401        3    NA        NA  NA   NA
#27  chr11 60800156 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#28  chr11 60800232 0.02373517 0.9762648345      152     6252    NA        NA  NA   NA
#29  chr11 60800237 0.74047470 0.2595252967     4742     1662    NA        NA  NA   NA
#30  chr11 60800246 0.46424110 0.5357589007     2973     3431    NA        NA  NA   NA
#31  chr11 60800260 0.99875078 0.0012492192     6396        8    NA        NA  NA   NA
#32  chr11 60800263 0.46876952 0.5312304809     3002     3402    NA        NA  NA   NA
#33  chr11 60800267 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#34  chr11 60800290 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#35  chr11 60800342 0.99875078 0.0012492192     6396        8    NA        NA  NA   NA
#36  chr11 60800365 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#37  chr11 60800379 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#38  chr11 60800387 0.99953154 0.0004684572     6401        3    NA        NA  NA   NA
#39  chr11 60800394 0.46892567 0.5310743285     3003     3401    NA        NA  NA   NA
#40  chr11 60800431 0.99937539 0.0003123048     6400        2    NA 1051.7925  NA   NA
#41  chr11 60800444 0.99953154 0.0004684572     6401        3    NA 2096.8913  NA   NA
#42  chr11 60800450 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#43  chr11 60800455 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#44  chr11 60800468 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#45  chr11 60800504 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#46  chr11 60800539 0.96783260 0.0321673954     6198      206    NA        NA  NA   NA
#47  chr11 60800554 0.99750156 0.0024984385     6388       16    NA        NA  NA   NA
#48  chr11 60800604 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#49  chr11 60800615 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#50  chr11 60800638 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#51  chr11 60800682 0.56183635 0.4381636477     3598     2806    NA        NA  NA   NA
#52  chr11 60800689 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#53  chr11 60800709 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#54  chr11 60800727 0.46158651 0.5384134916     2956     3448    NA        NA  NA   NA
#55  chr11 60800739 0.99968770 0.0003123048     6402        2    NA  197.7187  NA   NA
#56  chr11 60800742 0.98438476 0.0156152405     6304      100    NA        NA  NA   NA
#57  chr11 60800785 0.24484697 0.7378201124     1568     4725    NA        NA  NA   NA
#58  chr11 60800858 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#59  chr11 60800863 0.99718926 0.0028107433     6386       18    NA        NA  NA   NA
#60  chr11 60800865 0.99953154 0.0004684572     6401        3    NA        NA  NA   NA
#61  chr11 60800874 0.99968770 0.0003123048     6402        2    NA 1909.8800  NA   NA
#62  chr11 60800875 0.99953154 0.0003123048     6401        2    NA 1909.8800  NA   NA
#63  chr11 60800876 0.99718926 0.0024984385     6386       16    NA        NA  NA   NA
#64  chr11 60800897 0.99937539 0.0003123048     6400        2    NA 1909.8800  NA   NA
#65  chr11 60800918 0.99843848 0.0012492192     6394        8    NA        NA  NA   NA
#66  chr11 60800937 0.99953154 0.0004684572     6401        3    NA        NA  NA   NA
#67  chr11 60800938 0.99953154 0.0004684572     6401        3    NA 1141.1717  NA   NA
#68  chr11 60800940 0.99515928 0.0048407245     6373       31    NA        NA  NA   NA
#69  chr11 60800943 0.46346034 0.5365396627     2968     3436    NA        NA  NA   NA
#70  chr11 60800950 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#71  chr11 60800969 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#72  chr11 60800995 0.99937539 0.0006246096     6400        4    NA        NA  NA   NA
#73  chr11 60801019 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#74  chr11 60801032 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#75  chr11 60801034 0.99953154 0.0004684572     6401        3    NA 1269.2029  NA   NA
#76  chr11 60801035 0.02701437 0.9729856340      173     6231    NA        NA  NA   NA
#77  chr11 60801038 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#78  chr11 60801040 0.71424110 0.2857589007     4574     1830    NA        NA  NA   NA
#79  chr11 60801044 0.99625234 0.0037476577     6380       24    NA        NA  NA   NA
#80  chr11 60801095 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#81  chr11 60801114 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#82  chr11 60801146 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#83  chr11 60801152 0.99968770 0.0003123048     6402        2    NA 4211.9200  NA   NA
#84  chr11 60801177 0.97454716 0.0254528420     6241      163    NA        NA  NA   NA
#85  chr11 60801228 0.45893192 0.5410680824     2939     3465    NA        NA  NA   NA
#86  chr11 60801255 0.99906309 0.0009369144     6398        6    NA        NA  NA   NA
#87  chr11 60801264 0.99312929 0.0068707058     6360       44    NA        NA  NA   NA
#88  chr11 60801274 0.99750156 0.0024984385     6388       16    NA        NA  NA   NA
#89  chr11 60801289 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#90  chr11 60801290 0.98235478 0.0176452217     6291      113    NA        NA  NA   NA
#91  chr11 60801295 0.46642723 0.5335727670     2987     3417    NA        NA  NA   NA
#92  chr11 60801302 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#93  chr11 60801315 0.99984385 0.0001561524     6403        1    NA    0.0000  NA   NA
#94  chr11 60801320 0.99968770 0.0003123048     6402        2    NA  284.9762  NA   NA
#95  chr11 60801321 0.45877577 0.5412242349     2938     3466    NA        NA  NA   NA
#96  chr11 60801334 0.99937539 0.0006246096     6400        4    NA        NA  NA   NA
#97  chr11 60801351 0.96845721 0.0315427858     6202      202    NA        NA  NA   NA
#98  chr11 60801377 0.99562773 0.0043722673     6376       28    NA        NA  NA   NA
#99  chr11 60801387 0.99968770 0.0003123048     6402        2    NA        NA  NA   NA
#100 chr11 60801392 0.99921924 0.0007807620     6399        5    NA        NA  NA   NA
#[ reached 'max' / getOption("max.print") -- omitted 2102 rows ]

#Adding IHS values to scan and ihs get the maximum IHH and IHS
scan <- scan_hh(hh, polarized=FALSE)
scan
ihs <- ihh2ihs(scan, freqbin=1)
ihs
$ihs
CHR POSITION         IHS  LOGPVALUE
4    chr11 60799757          NA         NA
22   chr11 60800052          NA         NA
23   chr11 60800061          NA         NA
24   chr11 60800116          NA         NA
29   chr11 60800237          NA         NA
30   chr11 60800246          NA         NA
32   chr11 60800263          NA         NA
39   chr11 60800394          NA         NA
51   chr11 60800682          NA         NA
54   chr11 60800727          NA         NA
57   chr11 60800785          NA         NA
69   chr11 60800943          NA         NA
78   chr11 60801040          NA         NA
85   chr11 60801228          NA         NA
91   chr11 60801295          NA         NA
95   chr11 60801321          NA         NA
157  chr11 60802212          NA         NA
160  chr11 60802260          NA         NA
165  chr11 60802440          NA         NA
200  chr11 60803379          NA         NA
201  chr11 60803384          NA         NA
234  chr11 60803898          NA         NA
239  chr11 60804011          NA         NA
240  chr11 60804013          NA         NA
242  chr11 60804023          NA         NA
243  chr11 60804444          NA         NA
254  chr11 60804560  0.25299630 0.09676288
277  chr11 60804959          NA         NA
338  chr11 60806170 -0.35321604 0.14030554
339  chr11 60806185 -0.35321604 0.14030554
361  chr11 60806645  0.81292212 0.38063249
362  chr11 60806647  0.92596633 0.45042850
372  chr11 60806788  0.24556380 0.09365423
384  chr11 60807165          NA         NA
388  chr11 60807341 -0.55499617 0.23739849
394  chr11 60807457          NA         NA
413  chr11 60807740          NA         NA
418  chr11 60807815  0.92381831 0.44906155
420  chr11 60807935 -0.44991651 0.18523939
492  chr11 60809598          NA         NA
527  chr11 60810529          NA         NA
533  chr11 60810732 -0.18487907 0.06888610
560  chr11 60811092          NA         NA
573  chr11 60811387          NA         NA
599  chr11 60812049  0.70600245 0.31858995
646  chr11 60813719          NA         NA
683  chr11 60814568 -0.21468362 0.08091458
690  chr11 60814615          NA         NA
703  chr11 60814752  0.15081805 0.05545848
704  chr11 60814756 -0.73860009 0.33710069
713  chr11 60814886  0.19045814 0.07111781
717  chr11 60814895 -0.80815545 0.37778484
724  chr11 60815107 -0.54780309 0.23371574
735  chr11 60815167 -0.57804500 0.24931134
756  chr11 60815312 -0.28094562 0.10860076
764  chr11 60815352 -0.02126257 0.00743049
824  chr11 60816348 -0.53876832 0.22911359
828  chr11 60816366  1.15797664 0.60752540
829  chr11 60816390  0.29507289 0.11467373
833  chr11 60816449 -0.18044790 0.06712006
838  chr11 60816573 -0.25324415 0.09686683
846  chr11 60816821 -0.20394371 0.07655003
886  chr11 60818182 -0.38971177 0.15692322
895  chr11 60818428 -0.72577687 0.32977682
903  chr11 60818603 -0.36873870 0.14732334
921  chr11 60819015  1.19640944 0.63537994
923  chr11 60819140  1.05749226 0.53717244
928  chr11 60819367  0.44855449 0.18458626
934  chr11 60819666 -0.53958363 0.22952783
935  chr11 60819702  0.70397266 0.31744899
936  chr11 60819709          NA         NA
966  chr11 60820414 -0.50364308 0.21146948
968  chr11 60820465 -0.52474397 0.22202164
980  chr11 60820763 -1.61717834 0.97535103
986  chr11 60820861 -0.65191377 0.28865109
987  chr11 60820892 -0.86048724 0.40946966
990  chr11 60820956  0.04598691 0.01622911
994  chr11 60821027 -0.63543621 0.27972163
995  chr11 60821036  0.05317723 0.01882008
1015 chr11 60821434  0.53226846 0.22581887
1019 chr11 60821664  0.08335287 0.02985266
1025 chr11 60821845  0.06115406 0.02171149
1039 chr11 60822026 -1.26511141 0.68648838
1073 chr11 60822672 -1.39157161 0.78501804
1086 chr11 60823045 -0.07297177 0.02602813
1101 chr11 60823343 -1.60265707 0.96253212
1105 chr11 60823474 -1.45960405 0.84043604
1114 chr11 60823635 -0.85291467 0.40482728
1118 chr11 60823754  0.11721072 0.04253970
1143 chr11 60824754 -2.47416256 1.87435963
1147 chr11 60824803          NA         NA
1158 chr11 60825137 -0.79594446 0.37052484
1159 chr11 60825176  0.12844213 0.04682084
1160 chr11 60825207 -1.49514925 0.87006695
1163 chr11 60825272 -1.34463704 0.74777223
1168 chr11 60825310 -0.15424016 0.05679228
1184 chr11 60825856          NA         NA
1191 chr11 60826091 -2.01041312 1.35273948
1192 chr11 60826167 -3.69496968 3.65774904
1193 chr11 60826168 -3.69464611 3.65719601
1197 chr11 60826244 -1.34860876 0.75089300
1203 chr11 60826455 -1.96708735 1.30827205
1209 chr11 60826601  0.72267761 0.32801491
1212 chr11 60826629  1.04138483 0.52622557
1220 chr11 60826776 -0.94678815 0.46376141
1222 chr11 60826783 -0.32435038 0.12745171
1223 chr11 60826784  0.24012299 0.09138905
1226 chr11 60826878  1.30737812 0.71877494
1240 chr11 60827188  1.17650949 0.62089156
1251 chr11 60827422  0.81792946 0.38363219
1252 chr11 60827532 -0.41214126 0.16734046
1258 chr11 60827685  0.91717543 0.44484420
1260 chr11 60827717 -0.18451463 0.06874063
1270 chr11 60827923  1.27624761 0.69493251
1280 chr11 60828279  0.45514109 0.18775013
1281 chr11 60828289  0.23032526 0.08733216
1283 chr11 60828366          NA         NA
1290 chr11 60828470 -0.11367041 0.04119774
1294 chr11 60828543  0.64181671 0.28316878
1303 chr11 60828700 -0.03840316 0.01351211
1309 chr11 60828839 -0.03277800 0.01150721
1345 chr11 60829808  0.83771744 0.39556936
1347 chr11 60829829 -0.28672236 0.11107677
1352 chr11 60829951  0.79207715 0.36823601
1361 chr11 60830023  0.79439330 0.36960619
1362 chr11 60830032  0.78953180 0.36673232
1363 chr11 60830065  0.86418410 0.41174313
1365 chr11 60830170  2.07278275 1.41802189
1367 chr11 60830235          NA         NA
1368 chr11 60830255          NA         NA
1371 chr11 60830320  0.75207949 0.34485843
1374 chr11 60830358  0.73596388 0.33559057
1381 chr11 60830602  1.48337642 0.86020139
1391 chr11 60830976  0.53249642 0.22593419
1393 chr11 60831010  0.90778933 0.43891110
1410 chr11 60831536  0.29889596 0.11632754
1411 chr11 60831540  0.92189097 0.44783638
1425 chr11 60831924  0.57528235 0.24787442
1426 chr11 60831948          NA         NA
1427 chr11 60832028  0.35952801 0.14315024
1436 chr11 60832216  0.31056017 0.12140065
1465 chr11 60833003  0.28680623 0.11111279
1466 chr11 60833007  0.28680623 0.11111279
1484 chr11 60833475  0.89964628 0.43378823
1504 chr11 60833950 -0.64392738 0.28431203
1511 chr11 60834124  1.19046851 0.63103978
1533 chr11 60834769          NA         NA
1535 chr11 60834824 -1.34121595 0.74508871
1551 chr11 60835366 -0.19743446 0.07392131
1565 chr11 60835736 -1.69024480 1.04104867
1570 chr11 60835825  0.96638364 0.47644570
1577 chr11 60836174 -1.24766431 0.67334874
1585 chr11 60836371 -0.10921960 0.03951575
1598 chr11 60836546 -1.04323934 0.52748130
1600 chr11 60836596  0.98629719 0.48947202
1603 chr11 60836629 -0.53064773 0.22499944
1604 chr11 60836631  0.56230499 0.24115754
1605 chr11 60836632  0.56230499 0.24115754
1606 chr11 60836637  0.57023734 0.24525675
1607 chr11 60836641  0.72563744 0.32969749
1614 chr11 60836751  1.29454870 0.70890665
1615 chr11 60836753  2.62316281 2.05989395
1621 chr11 60836927          NA         NA
1632 chr11 60837257  0.30481587 0.11889713
1660 chr11 60838074 -0.92767102 0.45151446
1672 chr11 60838293          NA         NA
1673 chr11 60838321  0.98781325 0.49046937
1706 chr11 60839230  1.05597963 0.53614056
1720 chr11 60839598  0.35137622 0.13947866
1727 chr11 60839790  1.47596893 0.85402016
1733 chr11 60839935 -0.19537103 0.07309062
1737 chr11 60840003          NA         NA
1738 chr11 60840069 -1.19230458 0.63237978
1742 chr11 60840299          NA         NA
1746 chr11 60840363  1.50257365 0.87631485
1753 chr11 60840594 -0.60734033 0.26470051
1759 chr11 60840819          NA         NA
1765 chr11 60840970 -1.15393544 0.60462705
1770 chr11 60841181  1.15318103 0.60408663
1776 chr11 60841366          NA         NA
1780 chr11 60841460  1.27810992 0.69634899
1787 chr11 60841717          NA         NA
1798 chr11 60841939  1.08876153 0.55868347
1822 chr11 60842499          NA         NA
1824 chr11 60842583 -0.58556288 0.25323405
1825 chr11 60842592          NA         NA
1833 chr11 60843065  0.07038400 0.02507952
1840 chr11 60843356  0.13348529 0.04875499
1854 chr11 60843783          NA         NA
1858 chr11 60843876  0.20724512 0.07788806
1865 chr11 60844046          NA         NA
1876 chr11 60844362          NA         NA
1878 chr11 60844390          NA         NA
1883 chr11 60844491          NA         NA
1889 chr11 60844742          NA         NA
1895 chr11 60844890          NA         NA
1935 chr11 60845884          NA         NA
1956 chr11 60846537          NA         NA
1972 chr11 60846873          NA         NA
1973 chr11 60846874          NA         NA
1974 chr11 60846884          NA         NA
1975 chr11 60846885          NA         NA
1978 chr11 60847063          NA         NA
1987 chr11 60847343          NA         NA
1989 chr11 60847403          NA         NA
1992 chr11 60847522          NA         NA
2032 chr11 60848275          NA         NA
2036 chr11 60848354          NA         NA
2037 chr11 60848441          NA         NA
2044 chr11 60848564          NA         NA
2076 chr11 60849685          NA         NA
2108 chr11 60850361          NA         NA
2109 chr11 60850440          NA         NA
2114 chr11 60850469          NA         NA
2115 chr11 60850509          NA         NA
2116 chr11 60850514          NA         NA
2117 chr11 60850516          NA         NA
2118 chr11 60850520          NA         NA
2121 chr11 60850661          NA         NA
2151 chr11 60851605          NA         NA
2164 chr11 60851814          NA         NA
2176 chr11 60852184          NA         NA
2180 chr11 60852291          NA         NA

$frequency.class
N_MRK  MEAN_UNIHS  SD_UNIHS  LOWER_QT  UPPER_QT
[0.05,0.95)   223 -0.02401144 0.5422745 -1.105397 0.7788794
#Maximum IHS is 2.07278275 based on the data frame
